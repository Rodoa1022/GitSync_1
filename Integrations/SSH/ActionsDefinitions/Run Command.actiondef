{"Name":"Run Command","Description":"Run command on a remote machine","Script":"from SiemplifyUtils import output_handler\nfrom SiemplifyAction import SiemplifyAction\nfrom SshManager import SshManager\n\n\n@output_handler\ndef main():\n    siemplify = SiemplifyAction()\n    server = siemplify.parameters.get(\"Remote Server\")\n    username = siemplify.parameters.get(\"Remote Username\")\n    password = siemplify.parameters.get(\"Remote Password\")\n    port = (\n        int(siemplify.parameters.get(\"Remote Port\"))\n        if siemplify.parameters.get(\"Remote Port\")\n        else 22\n    )\n    ssh_wrapper = SshManager(server, username, password, port)\n\n    command = siemplify.parameters[\"Command\"]\n    status_code, output, error = ssh_wrapper.run_command(command)\n    json_results = {}\n    if status_code == 0:\n        results = \"True\"\n        output_message = output.read()\n        json_results = {command: output_message, \"output\": output_message}\n    else:\n        results = \"False\"\n        output_message = error.read()\n\n    # add json\n    siemplify.result.add_result_json(json_results)\n    siemplify.end(output_message, results)\n\n\nif __name__ == \"__main__\":\n    main()\n","IntegrationIdentifier":"SSH","ScriptResultName":"results","DynamicResultsMetadata":[{"ResultName":"JsonResult","ResultExample":"{\"ifconfig\": \"ens32: flags=4163<UP,BROADCAST,RUNNING,MULTICAST>mtu1500\\ninet1.1.1.1netmask1.1.1.1broadcast1.1.1.1\\ninet6fe80: : 2156: 9c37: 7a0d: 87eprefixlen64scopeid0x20<link>\\nether00: 50: 56: b5: 70: e3txqueuelen1000(Ethernet)\\nRXpackets7448423bytes1077754116(1.0GiB)\\nRXerrors0dropped0overruns0frame0\\nTXpackets370155bytes44300304(42.2MiB)\\nTXerrors0dropped0overruns0carrier0collisions0\\n\\nlo: flags=73<UP,LOOPBACK,RUNNING>mtu65536\\ninet1.1.1.1netmask1.1.1.1\\ninet6: : 1prefixlen128scopeid0x10<host>\\nlooptxqueuelen1000(LocalLoopback)\\nRXpackets86bytes4780(4.6KiB)\\nRXerrors0dropped0overruns0frame0\\nTXpackets86bytes4780(4.6KiB)\\nTXerrors0dropped0overruns0carrier0collisions0\\n\\n\", \"output\": \"ens32: flags=4163<UP,BROADCAST,RUNNING,MULTICAST>mtu1500\\ninet1.1.1.1netmask1.1.1.1broadcast1.1.1.1\\ninet6fe80: : 2156: 9c37: 7a0d: 87eprefixlen64scopeid0x20<link>\\nether00: 50: 56: b5: 70: e3txqueuelen1000(Ethernet)\\nRXpackets7448423bytes1077754116(1.0GiB)\\nRXerrors0dropped0overruns0frame0\\nTXpackets370155bytes44300304(42.2MiB)\\nTXerrors0dropped0overruns0carrier0collisions0\\n\\nlo: flags=73<UP,LOOPBACK,RUNNING>mtu65536\\ninet1.1.1.1netmask1.1.1.1\\ninet6: : 1prefixlen128scopeid0x10<host>\\nlooptxqueuelen1000(LocalLoopback)\\nRXpackets86bytes4780(4.6KiB)\\nRXerrors0dropped0overruns0frame0\\nTXpackets86bytes4780(4.6KiB)\\nTXerrors0dropped0overruns0carrier0collisions0\\n\\n\"}","ShowResult":true}],"Creator":"admin","IsEnabled":true,"IsCustom":true,"IsSystem":false,"Version":1.0,"TimeoutSeconds":600,"IsAsync":null,"AsyncPollingIntervalInSeconds":3600,"TotalIntervalTimeoutForAsyncInSeconds":86400,"Parameters":[{"CustomActionId":0,"IsMandatory":true,"DefaultValue":"","Description":"Remote server address(e.g: x.x.x.x).","Name":"Remote Server","Value":"","Type":0,"OptionalValues":null,"OptionalValuesJson":null},{"CustomActionId":0,"IsMandatory":true,"DefaultValue":"","Description":"","Name":"Remote Username","Value":"","Type":0,"OptionalValues":null,"OptionalValuesJson":null},{"CustomActionId":0,"IsMandatory":true,"DefaultValue":"","Description":"","Name":"Remote Password","Value":"","Type":12,"OptionalValues":null,"OptionalValuesJson":null},{"CustomActionId":0,"IsMandatory":false,"DefaultValue":"","Description":"","Name":"Remote Port","Value":"","Type":0,"OptionalValues":null,"OptionalValuesJson":null},{"CustomActionId":0,"IsMandatory":true,"DefaultValue":"","Description":"Command content(e.g: ifconfig).","Name":"Command","Value":"","Type":0,"OptionalValues":null,"OptionalValuesJson":null}],"DefaultResultValue":null,"PythonVersion":"None","SimulationData":{"Entities":[]},"SimulationDataJson":"{\"Entities\": []}"}