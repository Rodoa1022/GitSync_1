{"Name":"List Connections","Description":"List all  connections on a remote machine","Script":"from SiemplifyUtils import output_handler\nfrom SiemplifyAction import *\nfrom SshManager import SshManager\n\n\n@output_handler\ndef main():\n    siemplify = SiemplifyAction()\n\n    server = siemplify.parameters.get(\"Remote Server\")\n    username = siemplify.parameters.get(\"Remote Username\")\n    password = siemplify.parameters.get(\"Remote Password\")\n    port = (\n        int(siemplify.parameters.get(\"Remote Port\"))\n        if siemplify.parameters.get(\"Remote Port\")\n        else 22\n    )\n    ssh_wrapper = SshManager(server, username, password, port)\n\n    status_code, output, error = ssh_wrapper.list_connections()\n    json_results = {}\n\n    if status_code == 0:\n        json_results = {\"Results\": output}\n        siemplify.result.add_data_table(\"Results:\", output)\n        results = \"True\"\n        output_message = \"Successfully added list of connections in CSV format\"\n    else:\n        results = \"False\"\n        output_message = error.read()\n\n    # add json\n    siemplify.result.add_result_json(json_results)\n    siemplify.end(output_message, results)\n\n\nif __name__ == \"__main__\":\n    main()\n","IntegrationIdentifier":"SSH","ScriptResultName":"results","DynamicResultsMetadata":[{"ResultName":"JsonResult","ResultExample":"{\"Results\": [\"Proto,Recv-Q,Send-Q,Local,Address,Foreign,Address,State,PID/Program,name\", \"tcp,0,0,0.0.0.0:111,0.0.0.0:*,LISTEN,1/systemd\", \"tcp,0,0,0.0.0.0:22,0.0.0.0:*,LISTEN,10624/sshd\"]}","ShowResult":true}],"Creator":"admin","IsEnabled":true,"IsCustom":true,"IsSystem":false,"Version":1.0,"TimeoutSeconds":600,"IsAsync":null,"AsyncPollingIntervalInSeconds":3600,"TotalIntervalTimeoutForAsyncInSeconds":86400,"Parameters":[{"CustomActionId":0,"IsMandatory":true,"DefaultValue":"","Description":"Remote server address(e.g: x.x.x.x).","Name":"Remote Server","Value":"","Type":0,"OptionalValues":null,"OptionalValuesJson":null},{"CustomActionId":0,"IsMandatory":true,"DefaultValue":"","Description":"","Name":"Remote Username","Value":"","Type":0,"OptionalValues":null,"OptionalValuesJson":null},{"CustomActionId":0,"IsMandatory":true,"DefaultValue":"","Description":"","Name":"Remote Password","Value":"","Type":12,"OptionalValues":null,"OptionalValuesJson":null},{"CustomActionId":0,"IsMandatory":false,"DefaultValue":"","Description":"","Name":"Remote Port","Value":"","Type":0,"OptionalValues":null,"OptionalValuesJson":null}],"DefaultResultValue":null,"PythonVersion":"None","SimulationData":{"Entities":[]},"SimulationDataJson":"{\"Entities\": []}"}