{"Name":"List Processes","Description":"List running processes on a remote machine","Script":"from SiemplifyUtils import output_handler\nfrom SiemplifyAction import *\nfrom SshManager import SshManager\n\n\n@output_handler\ndef main():\n    siemplify = SiemplifyAction()\n    server = siemplify.parameters.get(\"Remote Server\")\n    username = siemplify.parameters.get(\"Remote Username\")\n    password = siemplify.parameters.get(\"Remote Password\")\n    port = (\n        int(siemplify.parameters.get(\"Remote Port\"))\n        if siemplify.parameters.get(\"Remote Port\")\n        else 22\n    )\n    ssh_wrapper = SshManager(server, username, password, port)\n\n    status_code, output, error = ssh_wrapper.list_process()\n    json_results = {}\n\n    if status_code == 0:\n        siemplify.result.add_data_table(\"Results:\", output)\n        json_results = {\"Processes\": output}\n\n        results = \"True\"\n        output_message = \"Successfully added list of processes in CSV format\"\n    else:\n        results = \"False\"\n        output_message = error.read()\n\n    siemplify.result.add_result_json(json_results)\n    siemplify.end(output_message, results)\n\n\nif __name__ == \"__main__\":\n    main()\n","IntegrationIdentifier":"SSH","ScriptResultName":"results","DynamicResultsMetadata":[{"ResultName":"JsonResult","ResultExample":"{\"Processes\": [\"USER,PID,%CPU,%MEM,VSZ,RSS,TTY,STAT,START,TIME,COMMAND\", \"root,1,0.0,0.0,193656,6656,?,Ss,Jan16,0:24,/usr/lib/systemd/systemd --system --deserialize 24\", \"root,32142,0.0,0.0,0,0,?,S,Jan22,0:32,[kworker/3:1]\"]}","ShowResult":true}],"Creator":"admin","IsEnabled":true,"IsCustom":true,"IsSystem":false,"Version":1.0,"TimeoutSeconds":600,"IsAsync":null,"AsyncPollingIntervalInSeconds":3600,"TotalIntervalTimeoutForAsyncInSeconds":86400,"Parameters":[{"CustomActionId":0,"IsMandatory":true,"DefaultValue":"","Description":"Remote server address(e.g: x.x.x.x).","Name":"Remote Server","Value":"","Type":0,"OptionalValues":null,"OptionalValuesJson":null},{"CustomActionId":0,"IsMandatory":true,"DefaultValue":"","Description":"","Name":"Remote Username","Value":"","Type":0,"OptionalValues":null,"OptionalValuesJson":null},{"CustomActionId":0,"IsMandatory":true,"DefaultValue":"","Description":"","Name":"Remote Password","Value":"","Type":12,"OptionalValues":null,"OptionalValuesJson":null},{"CustomActionId":0,"IsMandatory":false,"DefaultValue":"22","Description":"The default port will be 22.","Name":"Remote Port","Value":"","Type":0,"OptionalValues":null,"OptionalValuesJson":null}],"DefaultResultValue":null,"PythonVersion":"None","SimulationData":{"Entities":[]},"SimulationDataJson":"{\"Entities\": []}"}